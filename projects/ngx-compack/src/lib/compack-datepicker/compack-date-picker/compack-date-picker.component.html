<ng-template [ngTemplateOutlet]="choseTemplate">
</ng-template>

<ng-template #lineTemplate>

  <div class="calendar_container">

    <input class="input" [ngClass]="{'short':!useTime, 'long':useTime }" [disabled]="disabled"
      (click)="openMenuPicker(menu)" readonly
      [value]="[selectStartDate, selectLastDate] | displayPeriodDate: rangeMode : fieldPlaceHolder: useTime">

    <label class="mark" for="dropdownForm3"></label>

    <div #menu class="menu_calendar" [ngClass]="{'visible_menu': menuIsVisiblr, 'hidden_menu': !menuIsVisiblr}">
      <ng-container *ngTemplateOutlet="picker"></ng-container>
    </div>

  </div>

</ng-template>

<ng-template #blockTemplate>

  <ng-container *ngTemplateOutlet="picker"></ng-container>

</ng-template>

<ng-template #iconTemplate>

  <div class="calendar_container">

    <svg xmlns="http://www.w3.org/2000/svg" [ngClass]="{'disabled':disabled}" viewBox="0 0 24 24"
      (click)="openMenuPicker(menu)">
      <path d="M0 0h24v24H0z" fill="none" />
      <path
        d="M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z" />
    </svg>

    <div #menu class="menu_calendar" [ngClass]="{'visible_menu': menuIsVisiblr, 'hidden_menu': !menuIsVisiblr}">
      <ng-container *ngTemplateOutlet="picker"></ng-container>
    </div>

  </div>

</ng-template>


<ng-template #picker>

  <div class="calendar">

    <div class="title">

      <div class="titile_name" (click)="openMonthSelector()">
        {{nameMonth}} {{selectedYear}}
      </div>

      <div class="titile_tool">
        <button (click)="previewMonth()" [disabled]="disabled">&lt;</button>
        <button (click)="nextMonth()" [disabled]="disabled">&gt;</button>
      </div>

      <div class="month_selector" [ngClass]="{'visible':menuMonthIsVisible}">
        <div class="month" *ngFor="let month of allMonth" (click)="selectMonth(month.order)">
          {{month.name}}
        </div>
      </div>

    </div>

    <div class="body" [ngClass]="{'disabled':disabled}">

      <table class="my-table">
        <thead>
          <tr>
            <th *ngFor="let name of calendarWeekName">
              <div>{{name}}</div>
            </th>
          </tr>
        </thead>

        <tbody (mouseout)="cleareTempSelected()">
          <tr *ngFor="let cal of calendar">
            <td *ngFor="let day of cal.week" [ngClass]="{
              'now_month': day.isDayThisMonth,
              'not_now_month': !day.isDayThisMonth,
              'now_day': day.isDayToday,
              'select_day': day.isSelected,
              'out_max_mim': day.isOutOfMaxMin,
              'day_in_range': day.isIncludeRage || day.isIncludeTempoRage
              }" (click)="selectDay(day, true)" (mouseover)="TempSelectEndPeriod(day)">
              <div class="cell">
                <div class="dot" *ngIf="!day.isDayThisMonth; else DigitalBlock"></div>
                <ng-template #DigitalBlock>
                  {{day.numberDay}}
                </ng-template>
                <span></span>
              </div>
            </td>
          </tr>
        </tbody>

      </table>

      <div class="field_selected_date" *ngIf="viewFieldSelectedDate">

        <ng-container *ngIf="rangeMode else singleDate">

          <ng-container *ngIf="useTime">

            <span class="field_container">

              <input maxlength="5" class="field time short_time" timeMask [(ngModel)]="selectStartTimeStr"
                [disabled]="disabled" placeholder="HH:mm" (ngModelChange)="onChangeSelectedStartTime()" />

              <input maxlength="5" class="field time short_time" timeMask [(ngModel)]="selectLastTimeStr"
                [disabled]="disabled" placeholder="HH:mm" (ngModelChange)="onChangeSelectedLastTime()" />

            </span>

          </ng-container>

          <span class="field_container">
            <input maxlength="10" class="field short_date" dateMask [(ngModel)]="selectStartDateStr"
              [disabled]="disabled" [readonly]="canAutoSelect" placeholder="dd.MM.yyyy"
              (ngModelChange)="onChangeSelectedStartDate()">
            <input maxlength="10" class="field short_date" dateMask [(ngModel)]="selectLastDateStr"
              [disabled]="disabled" [readonly]="canAutoSelect" placeholder="dd.MM.yyyy"
              (ngModelChange)="onChangeSelectedLastDate()">
          </span>

        </ng-container>

        <ng-template #singleDate>

          <ng-container *ngIf="useTime; else onlyDate">

            <span class="field_container">
              <input maxlength="10" class="field medium_date" dateMask [(ngModel)]="selectStartDateStr"
                [disabled]="disabled" [readonly]="canAutoSelect" placeholder="dd.MM.yyyy"
                (ngModelChange)="onChangeSelectedStartDate()">
              <input maxlength="5" class="field time medium_time" timeMask [(ngModel)]="selectStartTimeStr"
                [disabled]="disabled" placeholder="HH:mm" (ngModelChange)="onChangeSelectedStartTime()" />
            </span>

          </ng-container>

          <ng-template #onlyDate>

            <span class="field_container">
              <input maxlength="10" class="field large_date" dateMask [(ngModel)]="selectStartDateStr"
                [disabled]="disabled" [readonly]="canAutoSelect" placeholder="dd.MM.yyyy"
                (ngModelChange)="onChangeSelectedStartDate()">
            </span>

          </ng-template>

        </ng-template>

        <span class="error_message" *ngIf="error.isError && viewErrorMessage">
          {{error.errorMessage}}
        </span>

      </div>

      <div class="footer">
        <button class="btn" [disabled]='error.isError || disabled' (click)="acceptNewDate()">{{acceptBtn}}</button>
        <button class="btn" [disabled]="disabled" (click)="clearCalendar()">{{cancelBtn}}</button>
      </div>

    </div>
  </div>

</ng-template>